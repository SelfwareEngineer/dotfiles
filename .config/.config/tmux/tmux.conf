# leader r now reloads this tmux config
unbind r
bind r source-file ~/.config/tmux/tmux.conf

# :INFO: - FIX COLORS
# :FIX: - whatever's on the laptop/main tower might work better
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -ag terminal-overrides ",tmux-256color:sitm=\\E[3m,ritm=\\E[23m"

# Undercurl
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0

# Check if we are in WSL
if-shell 'test -n "$WSL_DISTRO_NAME"' {
  set -as terminal-overrides ',*:Setulc=\E[58::2::::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m' # underscore colours - needs tmux-3.0 (wsl2 in Windows Terminal)
}

#:INFO: BASICS
set -g prefix C-Space # change leader ("prefix") to spacebar
set -g base-index 1 # Make windows 1-indexed
set -g mouse on # enable mouse
setw -g mode-keys vi # vim-like cursor navigation (start with leader C-[)

# Open new panes in current dir
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# vim-like pane navigation (requires prefix; use if vim-tmux-navigator isn't working)
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Status bar customization
set-option -g status-position top # Move status bar to top of terminal
set -g status-bg '#006666'
set -g status-fg '#ffffff'

# List of TPM plugins
set -g @plugin 'tmux-plugins/tpm' # plugin manager itself
set -g @plugin 'tmux-plugins/tmux-sensible' # Basic ubiquitous defaults
set -g @plugin 'christoomey/vim-tmux-navigator' # vim-like pane navigation

# Init tmux plugin manager (leave this last)
run '~/.config/tmux/plugins/tpm/tpm'
